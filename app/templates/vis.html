<home-popup config="vc.config"></home-popup>
<article class="main-container container-fluid">
	<div class="main-row row">
		<section class="sidebar col-sm-3">
			<nav>
				<ul>
					<li ng-click="vc.openHomePopup()"><i class="fas fa-home"></i> ReefGauge</li>
					<li ng-click="vc.openContribute()"><i class="far fa-eye"></i> Contribute</li>
					<li><i class="fas fa-book"></i> Glossary</li>
				</ul>
			</nav>
			<div class="tabs row">
				<h2 class="col-md-6" ng-click="vc.setDataMode('science')" ng-class="vc.config.dataMode == 'science' ? 'tab-selected' : ''">Science</h2>
				<h2 class="col-md-6" ng-click="vc.setDataMode('community')" ng-class="vc.config.dataMode == 'community' ? 'tab-selected' : ''">Community</h2>
				<p></p>
			</div>
			<div class="tab-content row">
				<div class="col-sm-12" ng-show="vc.config.dataMode === 'science'">
					<div>
						<h3>Scientific Assessments of Reef Health</h3>
						<p>Between 2007 and 2016, scientists have conducted over 700 assessments of coral reefs throughout the Caribbean, Gulf of Mexico, and Western Atlantic. These assessments are part of the <a href="https://www.agrra.org/" target="_blank">Atlantic and Gulf Rapid Reef Assessment (AGRRA)</a> which help us understand how healthy a reef is by measuring dozens of factors related to coral, fish, and benthos. Each circle you see here represents a reef while its size and color represent key factors measured by the assessment.</p>
					</div>
					<div>
						<h3>Reef Health Indicators</h3>
						<div class="tile expandable" ng-repeat="k in vc.topLevelKeys" ng-click="vc.toggleScienceKeyTile(k)" ng-class="{'tile-selected': k.selected}">
							<h4>{{k.display_name}}</h4>
							<div ng-if="k.selected">
								<img ng-src="{{k.image}}">
								<p>{{k.description}}</p>
								<a ng-click="vc.goToCommunityGroup(k.group)">See community observations of {{k.group}} <i class="fas fa-arrow-right"></i></a>
							</div>
						</div>
					</div>
					<div>
						<h3>Explore all the Indicators</h3>
						<div class="btn-group var-select" uib-dropdown>
							<button id="color-button" type="button" class="btn btn-plain" uib-dropdown-toggle ng-disabled="disabled">
							Size points by {{vc.getKeyMeta(vc.config.science.sizeBy).display_name}} <span class="caret"></span>
							</button>
							<ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">
								<li role="menuitem" ng-repeat="prop in vc.config.keys" ng-click="vc.setScienceSize(prop.key)" ng-class="prop == vc.config.science.sizeBy ? 'selected-dropdown-item' : ''">{{prop.display_name}}</li>
							</ul>
					    </div>
						<div class="btn-group var-select" uib-dropdown>
							<button id="color-button" type="button" class="btn btn-plain" uib-dropdown-toggle ng-disabled="disabled">
							Color points by {{vc.getKeyMeta(vc.config.science.colorBy).display_name}} <span class="caret"></span>
							</button>
							<ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">
								<li role="menuitem" ng-repeat="prop in vc.config.keys" ng-click="vc.setScienceColor(prop.key)" ng-class="prop == vc.config.science.colorBy ? 'selected-dropdown-item' : ''">{{prop.display_name}}</li>
							</ul>
					    </div>					
					</div>
				</div>
				<div class="col-sm-12" ng-show="vc.config.dataMode === 'community'">
					<div>
						<h3>Community Observations of Coral Reefs</h3>
						<p>Visual observations of reef environments are key to understanding their health. ReefGauge has collected over 6,000 observations of relevant reef health indicators from the dive community. These observations are submitted through our <a href="https://www.inaturalist.org/projects/reefgauge" target="_blank">partnered citizen science project on iNaturalist</a>. Each square on the map represents one observation. Browse the different reef groups to see observations of key health indicators for that group.</p>
					</div>
					<div>
						<h3>Reef Groups</h3>
						<div class="tile expandable" ng-repeat="g in vc.communityFilterGroups" ng-click="vc.toggleCommunityFilterGroup(g)" ng-class="{'tile-selected': g.selected}">
							<h4>{{g.name}}</h4>
							<div ng-if="g.selected">
								<p>{{g.info}}</p>
								<button class="btn btn-plain" ng-if="!vc.hasAnyCheckedFilters(g)" ng-click="vc.checkAllFiltersInGroup(g)">Check All</button>
								<button class="btn btn-plain" ng-if="vc.hasAnyCheckedFilters(g)" ng-click="vc.uncheckAllFiltersInGroup(g)">Uncheck All</button>
								<ul class="checkbox-list">
									<li ng-repeat="f in g.filters"><input type="checkbox" ng-model="f.checked" ng-change="vc.setCommunityFilters(g)"><label>{{vc.getFilterDisplayName(f)}}<i ng-if="g.name==='Benthos'"> {{f.promoter ? 'promoter' : 'detractor'}}</i></label></li>
								</ul>
								<a ng-click="vc.goToScienceKey(g.name)">See scientific assessments of {{g.name}} <i class="fas fa-arrow-right"></i></a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<section class="vis-container col-md-9">
			<map></map>
			<drilldown></drilldown>
			<legend config="vc.config"></legend>
		</section>
	</div>
</article>